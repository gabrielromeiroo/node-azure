name: 'Deploy Production to Server'

on:
  push:
    branches:
      - main


env:
    RELEASE_PATH: '/home/www/actions'

jobs:
    deploy:
        runs-on: ubuntu-latest

        steps:
            # Cópia o código do github para a máquina do Workflow
            - name: Checkout Code
              uses: actions/checkout@v2
             
            - name: Transfer files to server
              uses: appleboy/scp-action@v0.1.3
              with:
                host: ${{ secrets.HOST }}
                username: ${{ secrets.USERNAME }}
                key: ${{ secrets.KEY }}
                source: '.,!./uploads'
                target: ${{ env.RELEASE_PATH }}/build